<!DOCTYPE html>
<html>
<head>
  <title>Step Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <h1>Step Tracker</h1>
  <button onclick="connect()">Connect</button>
  <p><strong>Steps:</strong> <span id="steps">-</span></p>
  <p><strong>Pace:</strong> <span id="pace">-</span></p>

  <script>


    function parseData(data) {
      const text = new TextDecoder().decode(data);
      const match = text.match(/STEPS:(\d+),PACE:(\w+)/);
      if (match) {
        document.getElementById('steps').textContent = match[1];
        document.getElementById('pace').textContent = match[2];
      }
    }

   const serviceUUID = '0000ffe0-0000-1000-8000-00805f9b34fb';
  const notifyUUID = '0000ffe4-0000-1000-8000-00805f9b34fb';
  
  async function connect() {
    try {
      const device = await navigator.bluetooth.requestDevice({
        acceptAllDevices: true,
        optionalServices: [serviceUUID]
      });
  
      const server = await device.gatt.connect();
      const service = await server.getPrimaryService(serviceUUID);
      const char = await service.getCharacteristic(notifyUUID);
      await char.startNotifications();
      char.addEventListener('characteristicvaluechanged', event => {
        parseData(event.target.value);
      });
    } catch (err) {
      alert('Connection failed: ' + err);
    }
  }

  </script>
</body>
</html>
